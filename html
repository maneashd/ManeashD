<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQL Data Table</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 18px;
            text-align: left;
        }
        th, td {
            padding: 12px;
            border: 1px solid #ddd;
        }
        th {
            background-color: #f4f4f4;
        }
        td:hover {
            background-color: #f1f1f1;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h1>Database Output</h1>
    <table id="data-table">
        <thead>
            <!-- Table headers will be dynamically generated here -->
        </thead>
        <tbody>
            <!-- Table rows will be dynamically generated here -->
        </tbody>
    </table>

    <script>
        // Fetch data from Flask API
        fetch('/get-data')
            .then(response => response.json())
            .then(data => {
                const table = document.getElementById('data-table');
                const tableHead = table.querySelector('thead');
                const tableBody = table.querySelector('tbody');

                // Generate headers dynamically from the keys of the first row
                if (data.length > 0) {
                    const headers = Object.keys(data[0]); // Extract column names
                    const headerRow = document.createElement('tr');
                    headers.forEach(header => {
                        const th = document.createElement('th');
                        th.textContent = header; // Use the column name directly
                        headerRow.appendChild(th);
                    });
                    tableHead.appendChild(headerRow);
                }

                // Generate rows dynamically
                data.forEach(row => {
                    const tableRow = document.createElement('tr');
                    Object.values(row).forEach((value, index) => {
                        const cell = document.createElement('td');
                        if (index === Object.keys(row).length - 1) {
                            // Handle the spark output column separately
                            cell.innerHTML = `${value.substring(0, 20)}...`;
                            cell.ondblclick = function () {
                                alert('Spark Output:\n' + value);
                            };
                        } else {
                            cell.textContent = value;
                        }
                        tableRow.appendChild(cell);
                    });
                    tableBody.appendChild(tableRow);
                });
            })
            .catch(error => console.error('Error fetching data:', error));
    </script>
</body>
</html>
